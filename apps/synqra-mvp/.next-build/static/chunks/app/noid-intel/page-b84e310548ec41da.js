(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5980],{2425:(e,t,a)=>{Promise.resolve().then(a.bind(a,2917))},2917:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>T});var s=a(4568),r=a(7620),l=a(9772);let n=l.Ik({base:l.ai(),bonus:l.ai(),tips:l.ai(),reimbursements:l.ai(),adjustments:l.ai().optional()}),i=l.Ik({id:l.Yj(),serviceType:l.k5(["delivery","rideshare","freight","other"]).optional(),payout:n,distanceMiles:l.ai(),durationMinutes:l.ai(),weightLbs:l.ai().optional(),multiStop:l.zM().optional(),stops:l.YO(l.Ik({id:l.Yj(),sequence:l.ai(),distanceFromPrevMiles:l.ai().optional(),eta:l.Yj().optional(),weightLbs:l.ai().optional(),notes:l.Yj().optional()})).optional(),acceptedAt:l.Yj(),completedAt:l.Yj(),rating:l.ai().optional(),metadata:l.g1(l.Yj(),l.bz()).optional()}),o=l.Ik({date:l.Yj(),grossTotal:l.ai(),netTotal:l.ai(),expensesTotal:l.ai(),totalAdjustments:l.ai(),totalMiles:l.ai(),activeMinutes:l.ai(),earningsPerHour:l.ai(),earningsPerMile:l.ai(),varianceFromTargetPerHour:l.ai().optional(),byServiceType:l.g1(l.Yj(),l.ai()),offers:l.YO(l.Ik({offerId:l.Yj(),gross:l.ai(),net:l.ai(),mileage:l.ai(),durationMinutes:l.ai(),payoutBreakdown:n,expenseImpact:l.YO(l.Ik({expense:l.Ik({category:l.k5(["fuel","maintenance","parking","tolls","rentals","insurance","other"]),amount:l.ai(),label:l.Yj().optional(),timestamp:l.Yj().optional()}),appliedTo:l.Yj().optional()})),serviceType:l.k5(["delivery","rideshare","freight","other"]).optional()}))}),c=l.Ik({score:l.ai(),fatigueRisk:l.k5(["low","moderate","high"]),hydrationStatus:l.k5(["ok","low","unknown"]),sleepDebtHours:l.ai().optional(),cooldownMinutes:l.ai().optional(),recommendations:l.YO(l.Yj()),factors:l.g1(l.Yj(),l.ai())}),d=l.Ik({total:l.ai(),normalized:l.ai(),breakdown:l.Ik({total:l.ai(),components:l.Ik({distance:l.ai(),payout:l.ai(),duration:l.ai(),multiStop:l.ai(),weight:l.ai(),rating:l.ai(),custom:l.g1(l.Yj(),l.ai()).optional()}),reasons:l.YO(l.Yj())}),metadata:l.g1(l.Yj(),l.bz()).optional()});async function u(e,t,a){var s;let r=await fetch("/api/driver-intel",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:e,...t})});if(!r.ok){let e=await r.text();throw Error("Driver Intel API error (".concat(r.status,"): ").concat(e))}let l=await r.json(),n=null!==(s=l.data)&&void 0!==s?s:l.result,i=a.safeParse(n);if(!i.success)throw Error("Driver Intel parse error: ".concat(i.error.message,"; raw=").concat(JSON.stringify(n)));return i.data}async function x(e){return u("scoreOffer",{offer:i.parse(e)},d)}async function m(e){return u("dailyEarnings",e,o)}async function p(e){return u("health",e,c)}function h(e){var t;let a=null!==(t=e.refreshMs)&&void 0!==t?t:6e4,[s,l]=(0,r.useState)(!1),[n,i]=(0,r.useState)(null),[o,c]=(0,r.useState)(null),[d,u]=(0,r.useState)(0),[x,p]=(0,r.useState)(0),[h,f]=(0,r.useState)(0),[g,v]=(0,r.useState)(0),[b,j]=(0,r.useState)(0),y=(0,r.useCallback)(async()=>{l(!0),i(null);try{let t=await m({day:e.day,vehicleCostPerMile:e.vehicleCostPerMile,targetEarningsPerHour:e.targetEarningsPerHour});u(t.grossTotal),p(t.netTotal),f(t.earningsPerMile),v(t.earningsPerHour),j(void 0!==t.varianceFromTargetPerHour?t.netTotal+t.varianceFromTargetPerHour:t.netTotal),c(new Date().toISOString())}catch(e){i(e instanceof Error?e.message:"Unknown error")}finally{l(!1)}},[e.day,e.vehicleCostPerMile,e.targetEarningsPerHour]);return(0,r.useEffect)(()=>{y();let e=setInterval(y,a);return()=>clearInterval(e)},[y,a]),{metrics:(0,r.useMemo)(()=>({gross:d,net:x,perMile:h,perHour:g,projection:b}),[d,x,h,g,b]),loading:s,error:n,lastUpdated:o,refresh:y}}function f(e){var t,a;let s=(null!==(t=null==e?void 0:e.inactivityMinutes)&&void 0!==t?t:15)*6e4,l=(null!==(a=null==e?void 0:e.healthPollSeconds)&&void 0!==a?a:60)*1e3,[n,i]=(0,r.useState)(null),[o,c]=(0,r.useState)(0),[d,u]=(0,r.useState)(!1),[x,m]=(0,r.useState)(null),h=(0,r.useRef)(null),f=(0,r.useRef)(null),g=(0,r.useRef)(null),v=(0,r.useCallback)(()=>{h.current=Date.now(),d&&u(!1)},[d]),b=(0,r.useCallback)(()=>{let e=Date.now();i(e),c(0),u(!1),h.current=e},[]),j=(0,r.useCallback)(()=>{i(null),u(!1),f.current&&clearInterval(f.current),g.current&&clearInterval(g.current)},[]),y=(0,r.useCallback)(()=>{i(null),c(0),u(!1),m(null),h.current=null,f.current&&clearInterval(f.current),g.current&&clearInterval(g.current)},[]);return(0,r.useEffect)(()=>{if(n)return f.current=setInterval(()=>{var e;c(Date.now()-n);let t=null!==(e=h.current)&&void 0!==e?e:n;Date.now()-t>=s&&u(!0)},1e3),()=>{f.current&&clearInterval(f.current)}},[n,s]),(0,r.useEffect)(()=>{if(!n)return;let t=async()=>{try{var t,a,s;let r=null!==(a=null==e?void 0:null===(t=e.snapshotProvider)||void 0===t?void 0:t.call(e))&&void 0!==a?a:{timestamp:new Date().toISOString()},l=await p({snapshot:r,hoursDriven:o/36e5,lastBreakMinutesAgo:(Date.now()-(null!==(s=h.current)&&void 0!==s?s:n))/6e4});m(l)}catch(e){console.warn("driver health check failed",e)}};return t(),g.current=setInterval(t,l),()=>{g.current&&clearInterval(g.current)}},[n,o,l,null==e?void 0:e.snapshotProvider]),{startedAt:n,elapsedMs:o,onBreak:d,health:x,startShift:b,stopShift:j,reset:y,recordActivity:v}}function g(e){var t,a;let[s,l]=(0,r.useState)(null),[n,i]=(0,r.useState)(!1),[o,c]=(0,r.useState)(null),d=(0,r.useMemo)(()=>s?s.score>=70?"optimal":s.score>=40?"caution":"fatigued":null,[s]);return(0,r.useEffect)(()=>{var t;let a=null,s=async()=>{i(!0),c(null);try{var t,a;let s=null!==(a=null==e?void 0:null===(t=e.snapshotProvider)||void 0===t?void 0:t.call(e))&&void 0!==a?a:{timestamp:new Date().toISOString()},r=await p({snapshot:s,hoursDriven:null==e?void 0:e.hoursDriven,lastBreakMinutesAgo:null==e?void 0:e.lastBreakMinutesAgo});l(r)}catch(e){c(e instanceof Error?e.message:"Unknown error")}finally{i(!1)}};return s(),a=setInterval(s,(null!==(t=null==e?void 0:e.pollSeconds)&&void 0!==t?t:60)*1e3),()=>{a&&clearInterval(a)}},[null==e?void 0:e.pollSeconds,null==e?void 0:e.snapshotProvider,null==e?void 0:e.hoursDriven,null==e?void 0:e.lastBreakMinutesAgo]),{health:s,loading:n,error:o,status:d,score:null!==(t=null==s?void 0:s.score)&&void 0!==t?t:null,recommendations:null!==(a=null==s?void 0:s.recommendations)&&void 0!==a?a:[]}}let v=e=>1.60934*e;function b(e){var t,a,l,n;let{day:i,targetEarningsPerHour:o,snapshotProvider:c}=e,{metrics:d,loading:u}=h({day:i,targetEarningsPerHour:o}),{elapsedMs:m,onBreak:p,startShift:b,stopShift:y}=f({inactivityMinutes:15,healthPollSeconds:60,snapshotProvider:c}),{health:N,status:S}=g({pollSeconds:60,snapshotProvider:c}),{preview:w,scoreOffer:M,loading:k}=function(){let[e,t]=(0,r.useState)(null),[a,s]=(0,r.useState)(!1),[l,n]=(0,r.useState)(null);return{preview:e,scoreOffer:(0,r.useCallback)(async e=>{s(!0),n(null);try{var a,r,l,i,o,c;let s=await x(e),n=s.breakdown,d=null!==(a=n.components)&&void 0!==a?a:{distance:0,payout:0,duration:0,weight:0,multiStop:0,rating:0},u={distanceScore:null!==(r=d.distance)&&void 0!==r?r:0,payoutScore:null!==(l=d.payout)&&void 0!==l?l:0,timeScore:null!==(i=d.duration)&&void 0!==i?i:0,weightScore:null!==(o=d.weight)&&void 0!==o?o:0,totalScore:s.normalized,rationale:null!==(c=n.reasons)&&void 0!==c?c:[],raw:s};return t(u),u}catch(e){throw n(e instanceof Error?e.message:"Unknown error"),e}finally{s(!1)}},[]),loading:a,error:l}}();(0,r.useEffect)(()=>(b(),()=>y()),[b,y]);let I=(0,r.useMemo)(()=>v(i.offers.reduce((e,t)=>{var a;return e+(null!==(a=t.distanceMiles)&&void 0!==a?a:0)},0)),[i.offers]),D=(0,r.useMemo)(()=>{let e=Math.max(0,Math.floor(m/1e3)),t=Math.floor(e/3600).toString().padStart(2,"0"),a=Math.floor(e%3600/60).toString().padStart(2,"0");return"".concat(t,":").concat(a)},[m]),O=(0,r.useMemo)(()=>{switch(S){case"optimal":return"text-emerald-400";case"caution":return"text-amber-400";case"fatigued":return"text-rose-400";default:return"text-neutral-400"}},[S]),P=(0,r.useMemo)(()=>{let e=Math.min(120,32+.05*d.net);return"".concat(e,"px")},[d.net]),E=(0,r.useMemo)(()=>N?"optimal"===S?"System optimal":"caution"===S?"System in caution":"System fatigued":"System check pending…",[N,S]),F=null!==(a=i.offers[0])&&void 0!==a?a:{id:"sample-offer",payout:{base:8,bonus:2,tips:3,reimbursements:0},distanceMiles:5,durationMinutes:24,acceptedAt:new Date().toISOString(),completedAt:new Date().toISOString(),weightLbs:15,multiStop:!1},T=async()=>{await M(F)};return(0,s.jsxs)("div",{className:"mb-16 rounded-2xl border border-neutral-800 bg-neutral-900/80 p-8 text-white shadow-xl space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs uppercase tracking-wide text-neutral-400",children:"Shift"}),(0,s.jsx)("p",{className:"text-3xl font-semibold ".concat(p?"text-amber-300":"text-white"),children:D}),p&&(0,s.jsx)("p",{className:"text-xs text-amber-300",children:"Auto-break detected"})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsx)("p",{className:"text-xs text-neutral-400",children:"Health"}),(0,s.jsx)("p",{className:"text-xl font-semibold ".concat(O),children:null!==(l=null==N?void 0:N.score)&&void 0!==l?l:"…"}),(0,s.jsx)("p",{className:"text-xs text-neutral-400",children:E})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[(0,s.jsxs)("div",{className:"rounded-xl border border-neutral-800 bg-neutral-800/60 p-6 space-y-1",children:[(0,s.jsx)("p",{className:"text-neutral-400 text-xs uppercase",children:"Net Earnings"}),(0,s.jsxs)("p",{className:"text-2xl font-semibold",children:["$",d.net.toFixed(2)]}),(0,s.jsxs)("p",{className:"text-xs text-neutral-500",children:["$",d.perHour.toFixed(2)," / hr"]})]}),(0,s.jsxs)("div",{className:"rounded-xl border border-neutral-800 bg-neutral-800/60 p-6 space-y-1",children:[(0,s.jsx)("p",{className:"text-neutral-400 text-xs uppercase",children:"Km Driven"}),(0,s.jsxs)("p",{className:"text-2xl font-semibold",children:[I.toFixed(1)," km"]}),(0,s.jsxs)("p",{className:"text-xs text-neutral-500",children:[i.offers.length," offers"]})]}),(0,s.jsxs)("div",{className:"rounded-xl border border-neutral-800 bg-neutral-800/60 p-6 space-y-1",children:[(0,s.jsx)("p",{className:"text-neutral-400 text-xs uppercase",children:"Projection"}),(0,s.jsxs)("p",{className:"text-2xl font-semibold",children:["$",d.projection.toFixed(2)]}),(0,s.jsxs)("p",{className:"text-xs text-neutral-500",children:["Target: ",null!=o?o:"—"," / hr"]})]})]}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)("p",{className:"text-xs uppercase tracking-wide text-neutral-400",children:"Earnings Trend"}),(0,s.jsxs)("div",{className:"mt-3 h-32 rounded-xl border border-neutral-800 bg-gradient-to-b from-neutral-800 to-neutral-900 relative overflow-hidden",children:[(0,s.jsx)("div",{className:"absolute bottom-0 left-0 right-0 bg-emerald-500/60 transition-all duration-700 ease-out",style:{height:P,opacity:u?.6:1}}),(0,s.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-neutral-900 via-transparent to-transparent pointer-events-none"})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-2",children:[(0,s.jsxs)("div",{className:"rounded-xl border border-neutral-800 bg-neutral-800/70 p-8 space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs uppercase tracking-wide text-neutral-400",children:"System Status"}),(0,s.jsx)("p",{className:"text-lg font-semibold ".concat(O),children:N?"".concat(N.score," / 100"):"Monitoring…"})]}),(0,s.jsx)("div",{className:"h-14 w-14 rounded-full border-2 border-neutral-700 flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-sm font-semibold ".concat(O),children:null!=S?S:"—"})})]}),(0,s.jsx)("ul",{className:"text-xs text-neutral-300 space-y-1 list-disc list-inside",children:(null!==(n=null==N?void 0:N.recommendations)&&void 0!==n?n:["Rest status pending…"]).slice(0,3).map(e=>(0,s.jsx)("li",{children:e},e))})]}),(0,s.jsxs)("div",{className:"rounded-xl border border-neutral-800 bg-neutral-800/70 p-8 space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs uppercase tracking-wide text-neutral-400",children:"Offer Scoring Preview"}),(0,s.jsx)("p",{className:"text-sm text-neutral-300",children:"Score a sample offer to see fit"})]}),(0,s.jsx)("button",{type:"button",onClick:T,className:"rounded-lg bg-emerald-500 px-3 py-1 text-sm font-semibold text-neutral-900 hover:bg-emerald-400 transition",disabled:k,children:k?"Scoring…":"Score"})]}),w?(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[(0,s.jsx)(j,{label:"Distance",value:w.distanceScore}),(0,s.jsx)(j,{label:"Payout",value:w.payoutScore}),(0,s.jsx)(j,{label:"Time",value:w.timeScore}),(0,s.jsx)(j,{label:"Weight",value:w.weightScore}),(0,s.jsx)(j,{label:"Total",value:w.totalScore,highlight:!0})]}):(0,s.jsx)("p",{className:"text-sm text-neutral-500",children:"Run a preview to populate scores."}),(null==w?void 0:null===(t=w.rationale)||void 0===t?void 0:t.length)?(0,s.jsx)("ul",{className:"mt-3 text-xs text-neutral-300 space-y-1 list-disc list-inside",children:w.rationale.map(e=>(0,s.jsx)("li",{children:e},e))}):null]})]})]})}function j(e){let{label:t,value:a,highlight:r}=e;return(0,s.jsxs)("div",{className:"rounded-lg px-3 py-2 border ".concat(r?"border-emerald-400 bg-emerald-500/10":"border-neutral-700 bg-neutral-800/60"),children:[(0,s.jsx)("p",{className:"text-[11px] uppercase tracking-wide text-neutral-400",children:t}),(0,s.jsx)("p",{className:"text-base font-semibold",children:a.toFixed(1)})]})}let y=e=>{let t=Math.max(0,Math.floor(e/1e3)),a=Math.floor(t/3600).toString().padStart(2,"0"),s=Math.floor(t%3600/60).toString().padStart(2,"0"),r=Math.floor(t%60).toString().padStart(2,"0");return"".concat(a,":").concat(s,":").concat(r)};function N(e){var t,a,l;let{day:n,targetEarningsPerHour:i,snapshotProvider:o}=e,{metrics:c,loading:d}=h({day:n,targetEarningsPerHour:i}),{elapsedMs:u,onBreak:x,health:m,startShift:p,stopShift:g,reset:v}=f({snapshotProvider:o,inactivityMinutes:15,healthPollSeconds:60}),[b,j]=(0,r.useState)(0);(0,r.useEffect)(()=>(p(),()=>g()),[p,g]),(0,r.useEffect)(()=>{j(Math.min(1,c.perHour&&i?c.perHour/i:c.net>0?.6+Math.min(c.net/500,.4):0))},[c.net,c.perHour,i]);let N=(0,r.useMemo)(()=>{let e=Math.max(5,Math.min(360,360*b)),t=c.net>0?"rgba(16, 185, 129, 0.8)":"rgba(107, 114, 128, 0.6)";return{background:"conic-gradient(".concat(t," 0deg ").concat(e,"deg, rgba(55, 65, 81, 0.3) ").concat(e,"deg 360deg)"),transition:"background 0.8s ease"}},[b,c.net]),S=(0,r.useMemo)(()=>m?m.score>=70?"text-emerald-400":m.score>=40?"text-amber-400":"text-rose-400":"text-gray-400",[m]);return(0,s.jsxs)("div",{className:"w-full rounded-2xl bg-neutral-900 text-white p-8 shadow-lg border border-neutral-800 space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs uppercase tracking-wide text-neutral-400",children:"Shift"}),(0,s.jsx)("p",{className:"text-2xl font-semibold ".concat(x?"text-amber-300":"text-white"," ").concat(u?"animate-pulse":""),children:y(u)}),x&&(0,s.jsx)("p",{className:"text-xs text-amber-300",children:"Auto-break detected"})]}),(0,s.jsx)("button",{className:"text-xs text-neutral-300 underline hover:text-white",onClick:v,type:"button",children:"Reset"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4 items-center",children:[(0,s.jsx)("div",{className:"relative h-28 w-28 rounded-full flex items-center justify-center",style:N,children:(0,s.jsxs)("div",{className:"absolute inset-3 rounded-full bg-neutral-900 flex flex-col items-center justify-center",children:[(0,s.jsx)("p",{className:"text-[10px] uppercase tracking-wide text-neutral-400",children:"Net"}),(0,s.jsx)("p",{className:"text-lg font-semibold",children:d?"…":"$".concat(c.net.toFixed(2))}),(0,s.jsxs)("p",{className:"text-[10px] text-neutral-400",children:["$",c.perHour.toFixed(2),"/hr"]})]})}),(0,s.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-neutral-400",children:"Gross"}),(0,s.jsxs)("span",{children:["$",c.gross.toFixed(2)]})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-neutral-400",children:"Per Mile"}),(0,s.jsxs)("span",{children:["$",c.perMile.toFixed(2)]})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-neutral-400",children:"Projection"}),(0,s.jsxs)("span",{children:["$",c.projection.toFixed(2)]})]})]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs uppercase tracking-wide text-neutral-400",children:"Health"}),(0,s.jsx)("p",{className:"text-xl font-semibold ".concat(S),children:m?"".concat(m.score):"…"}),(null==m?void 0:m.fatigueRisk)&&(0,s.jsxs)("p",{className:"text-xs text-neutral-400",children:["Fatigue: ",m.fatigueRisk]})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsx)("p",{className:"text-xs text-neutral-400",children:"Hydration"}),(0,s.jsx)("p",{className:"text-sm",children:null!==(a=null==m?void 0:m.hydrationStatus)&&void 0!==a?a:"…"}),(0,s.jsxs)("p",{className:"text-xs text-neutral-400 mt-1",children:["Recommendations: ",null!==(l=null==m?void 0:null===(t=m.recommendations)||void 0===t?void 0:t[0])&&void 0!==l?l:"Monitoring…"]})]})]})]})}let S=e=>e/1.60934,w=e=>2.20462*e;function M(e){let{offers:t,onScore:a}=e,[l,n]=(0,r.useState)([]);return(0,r.useEffect)(()=>{let e=t[t.length-1];if(!e)return;let s={id:e.id,serviceType:"delivery",payout:{base:e.payout,bonus:0,tips:0,reimbursements:0,adjustments:0},distanceMiles:parseFloat(S(e.distanceKm).toFixed(2)),durationMinutes:Math.max(10,Math.round(3*e.distanceKm)),weightLbs:parseFloat(w(e.weightKg).toFixed(1)),multiStop:e.stops>1,stops:Array.from({length:e.stops}).map((t,a)=>({id:"".concat(e.id,"-stop-").concat(a+1),sequence:a+1})),acceptedAt:new Date().toISOString(),completedAt:new Date().toISOString()};(async()=>{try{let t=await x(s),r=t.normalized>=75?"GOOD":t.normalized>=50?"MID":"BAD",l={offer:e,completed:s,score:t,grade:r};n(e=>[l,...e].slice(0,5)),null==a||a(l)}catch(e){console.warn("Offer scoring failed",e)}})()},[t,a]),(0,s.jsxs)("div",{className:"rounded-2xl border border-emerald-500/20 bg-neutral-900/70 p-8 shadow-[0_0_22px_rgba(16,185,129,0.2)] backdrop-blur space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs uppercase tracking-wide text-neutral-400",children:"Offer Live Feed"}),(0,s.jsx)("p",{className:"text-sm text-neutral-300",children:"Last 5 incoming offers"})]}),(0,s.jsx)("span",{className:"text-[10px] px-2 py-1 rounded-full bg-emerald-500/10 text-emerald-300 border border-emerald-500/30 shadow-[0_0_12px_rgba(16,185,129,0.35)]",children:"Live"})]}),(0,s.jsxs)("div",{className:"space-y-6",children:[l.map(e=>(0,s.jsx)(k,{entry:e},e.offer.id)),!l.length&&(0,s.jsx)("p",{className:"text-sm text-neutral-500",children:"Waiting for offers…"})]})]})}function k(e){var t,a;let{entry:l}=e,{offer:n,score:i,grade:o}=l,c=(0,r.useMemo)(()=>{switch(o){case"GOOD":return"bg-emerald-500/10 text-emerald-300 border-emerald-500/30";case"MID":return"bg-amber-500/10 text-amber-300 border-amber-500/30";default:return"bg-rose-500/10 text-rose-300 border-rose-500/30"}},[o]),d=null!==(a=i.breakdown.components)&&void 0!==a?a:{};return(0,s.jsxs)("div",{className:"rounded-xl border border-neutral-800/70 bg-neutral-900/50 p-6 shadow-[0_0_12px_rgba(255,255,255,0.04)] backdrop-blur-sm space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"text-sm",children:[(0,s.jsx)("p",{className:"font-semibold",children:n.service}),(0,s.jsxs)("p",{className:"text-neutral-400 text-xs",children:[n.distanceKm," km • $",n.payout.toFixed(2)," • ",n.stops," stops"]})]}),(0,s.jsx)("span",{className:"text-[11px] px-2 py-1 rounded-full border ".concat(c),children:o})]}),(0,s.jsxs)("div",{className:"mt-2 grid grid-cols-5 gap-2 text-xs text-neutral-300",children:[(0,s.jsx)(I,{label:"Distance",value:d.distance}),(0,s.jsx)(I,{label:"Payout",value:d.payout}),(0,s.jsx)(I,{label:"Time",value:d.duration}),(0,s.jsx)(I,{label:"Weight",value:d.weight}),(0,s.jsx)(I,{label:"Total",value:i.normalized,highlight:!0})]}),(null===(t=i.breakdown.reasons)||void 0===t?void 0:t.length)?(0,s.jsx)("ul",{className:"mt-2 text-[11px] text-neutral-400 space-y-1 list-disc list-inside",children:i.breakdown.reasons.slice(0,3).map(e=>(0,s.jsx)("li",{children:e},e))}):null]})}function I(e){let{label:t,value:a,highlight:r}=e;return(0,s.jsxs)("div",{className:"rounded-lg border px-2 py-1 text-center ".concat(r?"border-emerald-400/60 bg-emerald-500/10 text-emerald-200":"border-neutral-700 bg-neutral-900/50 text-neutral-200"),children:[(0,s.jsx)("p",{className:"text-[10px] uppercase tracking-wide text-neutral-400",children:t}),(0,s.jsx)("p",{className:"text-sm font-semibold",children:(null!=a?a:0).toFixed(1)})]})}function D(e){let{children:t}=e;return(0,s.jsx)("div",{className:"min-h-screen bg-neutral-950 text-white",children:(0,s.jsx)("div",{className:"mx-auto max-w-6xl px-8 py-16 space-y-6",children:t})})}let O=(e,t)=>Math.random()*(t-e)+e,P=e=>e[Math.floor(Math.random()*e.length)],E=()=>"undefined"!=typeof crypto&&"function"==typeof crypto.randomUUID?crypto.randomUUID():Math.random().toString(36).slice(2),F=e=>e/1.60934;function T(){var e,t,a,l,n,i,o,c;let d=new Date().toISOString(),[u,x]=(0,r.useState)({id:"day-"+d.slice(0,10),date:d.slice(0,10),window:{start:new Date(new Date().setHours(8,0,0,0)).toISOString(),end:new Date(new Date().setHours(20,0,0,0)).toISOString()},offers:[],breaks:[]}),{offers:m,latest:p}=function(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e4,[a,s]=(0,r.useState)([]);(0,r.useEffect)(()=>{let e=()=>{s(e=>[...e,{id:"offer-".concat(E()),distanceKm:parseFloat(O(2,30).toFixed(1)),payout:parseFloat(O(6,45).toFixed(2)),weightKg:parseFloat(O(0,25).toFixed(1)),stops:Math.max(1,Math.floor(O(1,4.9))),service:P(["Spark","Uber","DoorDash"])}].slice(-20))};e();let a=setInterval(e,t);return()=>clearInterval(a)},[t]);let l=null!==(e=a[a.length-1])&&void 0!==e?e:null;return{offers:a,latest:l}}(1e4),{metrics:v}=h({day:u}),j=f({healthPollSeconds:60}),y=g(),[S,w]=(0,r.useState)(null);(0,r.useEffect)(()=>(j.startShift(),()=>j.stopShift()),[j.startShift,j.stopShift]),(0,r.useEffect)(()=>{if(!p)return;let e={id:p.id,serviceType:"delivery",payout:{base:p.payout,bonus:0,tips:0,reimbursements:0,adjustments:0},distanceMiles:parseFloat(F(p.distanceKm).toFixed(2)),durationMinutes:Math.max(10,Math.round(3*p.distanceKm)),weightLbs:parseFloat((2.20462*p.weightKg).toFixed(1)),multiStop:p.stops>1,stops:Array.from({length:p.stops}).map((e,t)=>({id:"".concat(p.id,"-stop-").concat(t+1),sequence:t+1})),acceptedAt:new Date().toISOString(),completedAt:new Date().toISOString()};x(t=>({...t,offers:[...t.offers,e].slice(-25)}))},[p]);let k=(0,r.useMemo)(()=>({hrBpm:72,hydrationOz:60,steps:5200,sleepHours:7,stressLevel:3,fatigueLevel:3,timestamp:new Date().toISOString()}),[]),I=(0,r.useMemo)(()=>S?"fatigued"===y.status?"DECLINE":S.score>=75?"ACCEPT":S.score<50?"DECLINE":"CAUTION":"CAUTION",[S,y.status]),T=null!==(l=null!==(a=null==S?void 0:S.offer)&&void 0!==a?a:p)&&void 0!==l?l:null;return(0,s.jsx)(D,{children:(0,s.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,s.jsx)(b,{day:u,targetEarningsPerHour:25,snapshotProvider:()=>k}),(0,s.jsx)(N,{day:u,targetEarningsPerHour:25,snapshotProvider:()=>k})]}),(0,s.jsx)(M,{offers:m.slice(-5),onScore:e=>{w({offer:e.offer,score:e.score.normalized})}}),(0,s.jsxs)("div",{className:"rounded-2xl border border-neutral-800 bg-neutral-900/80 p-4 shadow-[0_0_18px_rgba(16,185,129,0.18)]",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs uppercase tracking-wide text-neutral-400",children:"System Snapshot"}),(0,s.jsx)("p",{className:"text-sm text-neutral-300",children:"Live intelligence summary"})]}),(0,s.jsx)("span",{className:"text-[11px] px-3 py-1 rounded-full border shadow-[0_0_10px_rgba(255,255,255,0.08)] ".concat("ACCEPT"===I?"bg-emerald-500/15 border-emerald-400/50 text-emerald-200":"DECLINE"===I?"bg-rose-500/15 border-rose-400/50 text-rose-200":"bg-amber-500/15 border-amber-400/50 text-amber-200"),children:I})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 text-sm",children:[(0,s.jsx)(A,{label:"Shift",value:function(e){let t=Math.max(0,Math.floor(e/1e3)),a=Math.floor(t/3600).toString().padStart(2,"0"),s=Math.floor(t%3600/60).toString().padStart(2,"0");return"".concat(a,":").concat(s)}(j.elapsedMs)}),(0,s.jsx)(A,{label:"Earnings",value:"$".concat(v.net.toFixed(2))}),(0,s.jsx)(A,{label:"Health",value:y.score?"".concat(y.score):"…",sub:null!==(n=y.status)&&void 0!==n?n:"pending"}),(0,s.jsx)(A,{label:"Last Offer",value:T?"".concat(null!==(i=T.service)&&void 0!==i?i:"Offer"," ").concat(null!==(o=T.distanceKm)&&void 0!==o?o:0," km"):"—",sub:T?"$".concat(null!==(c=null===(t=T.payout)||void 0===t?void 0:null===(e=t.toFixed)||void 0===e?void 0:e.call(t,2))&&void 0!==c?c:T.payout):""}),(0,s.jsx)(A,{label:"Offer Score",value:S?S.score.toFixed(1):"—",sub:I})]})]})]})})}function A(e){let{label:t,value:a,sub:r}=e;return(0,s.jsxs)("div",{className:"rounded-xl border border-neutral-800 bg-neutral-800/60 p-3",children:[(0,s.jsx)("p",{className:"text-[11px] uppercase tracking-wide text-neutral-400",children:t}),(0,s.jsx)("p",{className:"text-lg font-semibold text-white",children:a}),r?(0,s.jsx)("p",{className:"text-xs text-neutral-500",children:r}):null]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[9772,587,2855,7358],()=>t(2425)),_N_E=e.O()}]);