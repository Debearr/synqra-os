(()=>{var e={};e.id=5015,e.ids=[4291,5015],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},1781:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>h,routeModule:()=>l,serverHooks:()=>d,workAsyncStorage:()=>S,workUnitAsyncStorage:()=>E});var a={};r.r(a),r.d(a,{GET:()=>c});var s=r(1271),n=r(1232),o=r(8079),i=r(1238),u=r(1525),p=r(4291);async function c(e){let t=new URL(e.url),r=t.searchParams.get("code");if(t.searchParams.get("error")||!r)return i.NextResponse.redirect(new URL("/studio",e.url));let a=(0,u.createClient)((0,p.getSupabaseUrl)(),(0,p.getSupabaseAnonKey)()),{error:s}=await a.auth.exchangeCodeForSession(r);if(!e.cookies.get("synqra_auth")?.value){let t;if(s)t=`oauth-${Date.now().toString(36)}-${Math.random().toString(36).substring(2,9)}`;else{let{data:{user:e}}=await a.auth.getUser();t=e?.email?`oauth-${e.email.split("@")[0]}-${Date.now().toString(36)}`:`oauth-${Date.now().toString(36)}`}let r=i.NextResponse.redirect(new URL("/studio",e.url));return r.cookies.set("synqra_auth",t,{path:"/",maxAge:86400,sameSite:"lax",secure:!0}),r}return i.NextResponse.redirect(new URL("/studio",e.url))}let l=new s.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/auth/callback/route",pathname:"/auth/callback",filename:"route",bundlePath:"app/auth/callback/route"},resolvedPagePath:"C:\\Projects\\Synqra\\apps\\synqra-mvp\\app\\auth\\callback\\route.ts",nextConfigOutput:"standalone",userland:a}),{workAsyncStorage:S,workUnitAsyncStorage:E,serverHooks:d}=l;function h(){return(0,o.patchFetch)({workAsyncStorage:S,workUnitAsyncStorage:E})}},7032:()=>{},408:()=>{},4291:(e,t,r)=>{"use strict";r.d(t,{F:()=>i,getSupabaseAnonKey:()=>o,getSupabaseUrl:()=>n});let a=["SUPABASE_SERVICE_KEY","SUPABASE_SERVICE_ROLE"];function s(e,t){if(!e||""===e.trim())throw Error(`[Supabase Env] ${t} is missing or empty`);return e}function n(){let e=s(process.env.SUPABASE_URL,"SUPABASE_URL");return function(e,t){try{let r=new URL(e);if("http:"!==r.protocol&&"https:"!==r.protocol)throw Error(`[Supabase Env] ${t} must start with http:// or https://`)}catch(e){throw Error(`[Supabase Env] ${t} is invalid: ${e instanceof Error?e.message:"Unknown URL error"}`)}}(e,"SUPABASE_URL"),e}function o(){return s(process.env.SUPABASE_ANON_KEY,"SUPABASE_ANON_KEY")}function i(){let e=process.env.SUPABASE_SERVICE_ROLE_KEY;if(e&&""!==e.trim())return e;for(let e of a){let t=process.env[e];if(t&&""!==t.trim())return console.warn(`[Supabase Env] Falling back to ${e}. Set SUPABASE_SERVICE_ROLE_KEY and restart.`),t}throw Error("[Supabase Env] SUPABASE_SERVICE_ROLE_KEY is missing or empty")}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[6207,8048,1525],()=>r(1781));module.exports=a})();