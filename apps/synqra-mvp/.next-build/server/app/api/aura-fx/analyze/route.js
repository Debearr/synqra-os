(()=>{var e={};e.id=5067,e.ids=[5067],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},4358:(e,t,i)=>{"use strict";i.r(t),i.d(t,{patchFetch:()=>y,routeModule:()=>S,serverHooks:()=>g,workAsyncStorage:()=>f,workUnitAsyncStorage:()=>m});var r={};i.r(r),i.d(r,{POST:()=>h});var n=i(1271),o=i(1232),s=i(8079),l=i(1238),a=i(4493),u=i(2780),c=i(6357);let p=a.Ik({time:a.ai(),open:a.ai(),high:a.ai(),low:a.ai(),close:a.ai(),volume:a.ai().optional(),timeframe:a.Yj().optional()}),d=a.Ik({symbol:a.Yj(),timeframe:a.Yj(),candles:a.YO(p).min(3),tzOffsetMinutes:a.ai().optional()});async function h(e){try{let t=await e.json(),i=d.safeParse(t);if(!i.success)return l.NextResponse.json({error:i.error.message},{status:400});let{symbol:r,timeframe:n,candles:o,tzOffsetMinutes:s}=i.data,a=(0,u.F)({candles:o,tzOffsetMinutes:s??0});return l.NextResponse.json({symbol:r,timeframe:n,result:a})}catch(t){let e=t instanceof Error?t.message:"Unknown error";return l.NextResponse.json({error:c.d,detail:e},{status:500})}}let S=new n.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/aura-fx/analyze/route",pathname:"/api/aura-fx/analyze",filename:"route",bundlePath:"app/api/aura-fx/analyze/route"},resolvedPagePath:"C:\\Projects\\Synqra\\apps\\synqra-mvp\\app\\api\\aura-fx\\analyze\\route.ts",nextConfigOutput:"standalone",userland:r}),{workAsyncStorage:f,workUnitAsyncStorage:m,serverHooks:g}=S;function y(){return(0,s.patchFetch)({workAsyncStorage:f,workUnitAsyncStorage:m})}},7032:()=>{},408:()=>{},2780:(e,t,i)=>{"use strict";i.d(t,{F:()=>p});let r={lookback:50,minSwingSizePct:.05},n=e=>`${(100*e).toFixed(2)}%`,o=[{label:"LONDON_OPEN",start:"07:00",end:"10:00"},{label:"NY_OPEN",start:"12:30",end:"16:00"},{label:"ASIA_RANGE",start:"23:00",end:"02:00"}];function s(e,t){let i=new Date(e);return i.setUTCHours(Math.floor(t/60),t%60,0,0),i.toISOString()}let l={minImpulsePct:.0015},a={minSizePct:5e-4},u={alignment:.35,liquidity:.3,timeframe:.2,time:.15},c=e=>Math.min(1,Math.max(0,e));function p(e){let{candles:t,trendDirection:i,tzOffsetMinutes:p=0}=e,d=function(e,t=0){let i=function(e,t){if(e.length<3)return{direction:"RANGE",reason:"Insufficient candles"};let{lookback:i}={...r},o=e.slice(-i),s=o[0],l=(o[o.length-1].close-s.close)/s.close;return l>.015?{direction:"BULLISH",reason:`Price up ${n(l)} over lookback`}:l<-.015?{direction:"BEARISH",reason:`Price down ${n(l)} over lookback`}:{direction:"RANGE",reason:`Sideways ${n(l)} over lookback`}}(e),l=function(e,t=2){let i=[];for(let r=t;r<e.length-t;r++){let n=e.slice(r-t,r),o=e.slice(r+1,r+1+t),s=e[r],l=n.every(e=>e.high<s.high)&&o.every(e=>e.high<s.high),a=n.every(e=>e.low>s.low)&&o.every(e=>e.low>s.low);l&&i.push({type:"SWING_HIGH",index:r,price:s.high,time:s.time}),a&&i.push({type:"SWING_LOW",index:r,price:s.low,time:s.time})}return i}(e,2),a=function(e){let t=[];if(e.length<2)return t;for(let i=1;i<e.length;i++){let r=e[i-1],n=e[i],o="SWING_LOW"===r.type&&"SWING_HIGH"===n.type?n.price>r.price?"BULLISH":"RANGE":"SWING_HIGH"===r.type&&"SWING_LOW"===n.type?n.price<r.price?"BEARISH":"RANGE":null;if(!o)continue;let s="BULLISH"===o&&"SWING_HIGH"===n.type&&n.price>r.price||"BEARISH"===o&&"SWING_LOW"===n.type&&n.price<r.price?"BOS":"CHOCH";t.push({type:s,direction:o,brokenLevel:r.price,atIndex:n.index,time:n.time,fromSwing:r,toSwing:n})}return t}(l),u=function(e,t){let i=[];for(let e=0;e<t.length-1;e++){let r=t[e],n=t[e+1],o=Math.abs(5e-4*r.price);Math.abs(r.price-n.price)<=o&&("SWING_HIGH"===r.type&&"SWING_HIGH"===n.type&&i.push({type:"BSL",price:(r.price+n.price)/2,reason:"equal_highs",indices:[r.index,n.index]}),"SWING_LOW"===r.type&&"SWING_LOW"===n.type&&i.push({type:"SSL",price:(r.price+n.price)/2,reason:"equal_lows",indices:[r.index,n.index]}))}let r=[...t].reverse().find(e=>"SWING_HIGH"===e.type),n=[...t].reverse().find(e=>"SWING_LOW"===e.type);if(r){let e=8e-4*r.price,t=r.price+e;i.push({type:"BSL",price:t,reason:"stop_cluster_high",indices:[r.index]})}if(n){let e=8e-4*n.price,t=n.price-e;i.push({type:"SSL",price:t,reason:"stop_cluster_low",indices:[n.index]})}return function(e){let t=new Map;for(let i of e){let e=`${i.type}-${i.reason}-${i.price.toFixed(5)}`;t.has(e)||t.set(e,i)}return Array.from(t.values())}(i)}(0,l);return{trend:i,structurePoints:l,structureEvents:a,liquidityPools:u,session:function(e,t=0){let i=new Date(e+6e4*t),r=60*i.getUTCHours()+i.getUTCMinutes();for(let e of o){let[t,n]=e.start.split(":").map(Number),[o,l]=e.end.split(":").map(Number),a=60*t+n,u=60*o+l;if(a<=u?r>=a&&r<=u:r>=a||r<=u)return{killzone:e.label,isActive:!0,window:{start:s(i,a),end:s(i,u)}}}return{killzone:"NONE",isActive:!1,window:{start:s(new Date(e),0),end:s(new Date(e),0)}}}(e[e.length-1]?.time??Date.now(),t)}}(t,p),h=function(e,t,i){let{minImpulsePct:r}={...l},n=[];for(let i=1;i<e.length-2;i++){e[i-1];let o=e[i],s=e[i+1],l="BULLISH"===t&&o.close<o.open&&s.close>o.high,a="BEARISH"===t&&o.close>o.open&&s.close<o.low;(l||a)&&(("BULLISH"===t?(s.close-o.low)/o.low:(o.high-s.close)/o.high)<r||n.push({type:l?"DEMAND":"SUPPLY",originIndex:i,priceRange:{low:o.low,high:o.high},isMitigated:!1}))}return n}(t,i??d.trend.direction),S=function(e,t){let{minSizePct:i}={...a},r=[];for(let t=0;t<e.length-2;t++){let n=e[t],o=e[t+1],s=e[t+2],l=o.low>n.high&&s.low>n.high,a=o.high<n.low&&s.high<n.low;(l||a)&&((l?(o.low-n.high)/n.high:(n.low-o.high)/n.low)<i||r.push({direction:l?"BULLISH":"BEARISH",priceRange:l?{low:n.high,high:o.low}:{low:o.high,high:n.low},startIndex:t,endIndex:t+2,isFilled:!1}))}return r}(t),f=function(e){let t=[],i=function(e,t){let i=e.trendDirection,r=e.orderBlocks.some(e=>"DEMAND"===e.type),n=e.orderBlocks.some(e=>"SUPPLY"===e.type),o=e.fairValueGaps.some(e=>"BULLISH"===e.direction),s=e.fairValueGaps.some(e=>"BEARISH"===e.direction),l=.5;"BULLISH"===i&&r&&(l+=.2,t.push("Bullish HTF with demand OB")),"BEARISH"===i&&n&&(l+=.2,t.push("Bearish HTF with supply OB")),"BULLISH"===i&&o&&(l+=.1,t.push("Bullish FVG supports continuation")),"BEARISH"===i&&s&&(l+=.1,t.push("Bearish FVG supports continuation"));let a=e.structureEvents.some(e=>"BEARISH"===e.direction),u=e.structureEvents.some(e=>"BULLISH"===e.direction);return"BULLISH"===i&&a&&(l-=.2,t.push("MSS/BOS against bullish trend")),"BEARISH"===i&&u&&(l-=.2,t.push("MSS/BOS against bearish trend")),c(l)}(e,t),r=function(e,t){let i=e.liquidityPools.filter(e=>"BSL"===e.type),r=e.liquidityPools.filter(e=>"SSL"===e.type),n=.5;return"BULLISH"===e.trendDirection&&r.length&&(n+=.2,t.push("Liquidity resting below (SSL) for potential sweep")),"BEARISH"===e.trendDirection&&i.length&&(n+=.2,t.push("Liquidity resting above (BSL) for potential sweep")),i.length&&r.length&&(n-=.1,t.push("Both BSL/SSL present; liquidity balanced")),c(n)}(e,t),n=e.multiTimeframeBias?e.multiTimeframeBias===e.trendDirection?(t.push("Multi-timeframe agreement"),.8):(t.push("Timeframe conflict â€“ stand aside."),.2):.5,o=e.killzone.isActive?(t.push(`${e.killzone.killzone} active`),.8):.4,s=i*u.alignment+r*u.liquidity+n*u.timeframe+o*u.time,l=function(e,t,i,r){if(e.multiTimeframeBias&&e.multiTimeframeBias!==e.trendDirection&&r<.3)return"NO_TRADE";let n=.5*t+.3*i+.2*r;return n>=.65?"BULLISH"===e.trendDirection?"LONG":"SHORT":n<=.4?"NO_TRADE":"BULLISH"===e.trendDirection?"LONG":"SHORT"}(e,i,r,n);return{trendScore:i,liquidityScore:r,structureScore:i,timeScore:o,overallScore:c(s),primaryBias:l,notes:t}}({trendDirection:i??d.trend.direction,structureEvents:d.structureEvents,liquidityPools:d.liquidityPools,orderBlocks:h,fairValueGaps:S,killzone:d.session});return{...d,orderBlocks:h,fairValueGaps:S,confluence:f}}},6357:(e,t,i)=>{"use strict";i.d(t,{d:()=>r});let r="An unexpected error occurred. Please try again."}};var t=require("../../../../webpack-runtime.js");t.C(e);var i=e=>t(t.s=e),r=t.X(0,[6207,8048,4493],()=>i(4358));module.exports=r})();