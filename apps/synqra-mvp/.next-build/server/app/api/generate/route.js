(()=>{var e={};e.id=5435,e.ids=[4291,5435],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},6069:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>A,routeModule:()=>h,serverHooks:()=>w,workAsyncStorage:()=>g,workUnitAsyncStorage:()=>b});var n={};r.r(n),r.d(n,{DELETE:()=>m,GET:()=>E,PATCH:()=>S,POST:()=>c,PUT:()=>f});var o=r(1271),s=r(1232),a=r(8079),i=r(1238);let u={youtube:[e=>`In this video: ${e}`,e=>`Here's what you need to know about ${e}`,e=>`Watch this if you want to understand ${e}`],tiktok:[e=>`POV: ${e}`,e=>`Wait for it... ${e}`,e=>`This changed everything: ${e}`],x:[e=>`Thread: ${e}`,e=>`Quick breakdown of ${e} ðŸ‘‡`,e=>`${e} - here's what actually matters:`],linkedin:[e=>`${e} - insights from the field`,e=>`Lessons learned: ${e}`,e=>`${e} | A practical guide`]},l={youtube:"Like and subscribe for more content like this",tiktok:"Follow for daily tips",x:"Repost if this helped you",linkedin:"Connect with me for more insights"};function p(e,t,r){let n=new Date().toISOString();console.log(`[CONTENT-GEN] ${n} | Job: ${e} | Brief: "${t.substring(0,50)}..." | Platforms: ${r.join(", ")}`)}var d=r(7164);async function c(e){try{let t=await e.json(),{searchParams:r}=new URL(e.url),n="true"===r.get("demo"),o="true"===(process.env.GENERATE_PERSIST_ENABLED||"").toLowerCase();if(!t.brief||!t.platforms||0===t.platforms.length)return i.NextResponse.json({error:"Invalid request",message:"Both 'brief' and 'platforms' are required"},{status:400});let{brief:s,platforms:a}=t,c=function(e,t){let r={};for(let n of t)r[n]=function(e,t){let r=u[t]||u.youtube,n=l[t]||l.youtube;return r.map((r,o)=>({hook:r(e),caption:`${e}`,cta:n,platform:t,variantIndex:o+1}))}(e,n);return r}(s,a),E="demo-"+Date.now();if(!(o&&!n))return p(E,s,a),i.NextResponse.json({jobId:E,brief:s,platforms:a,variants:c,demoMode:n,persisted:!1,message:n?"Demo mode: Content generated but not saved to database":"Content generated. Persistence disabled (set GENERATE_PERSIST_ENABLED=true to enable saving).",timestamp:new Date().toISOString()},{status:200});let f=(0,d.U)(),{data:m,error:S}=await f.from("content_jobs").insert({brief:s,platform:a.join(","),status:"completed"}).select().single();if(S)return console.error("Failed to create content job:",S),i.NextResponse.json({error:"Database error",message:S.message},{status:500});let h=Object.entries(c).flatMap(([e,t])=>t.map(e=>({job_id:m.id,hook:e.hook,caption:e.caption,cta:e.cta,platform:e.platform,variant_index:e.variantIndex}))),{data:g,error:b}=await f.from("content_variants").insert(h).select();if(b)return console.error("Failed to save content variants:",b),i.NextResponse.json({error:"Database error",message:b.message},{status:500});return p(m.id,s,a),i.NextResponse.json({jobId:m.id,brief:s,platforms:a,variants:c,savedCount:g?.length||0,persisted:!0,timestamp:new Date().toISOString()},{status:201})}catch(e){return console.error("Content generation error:",e),i.NextResponse.json({error:"Content generation failed",message:e instanceof Error?e.message:"Unknown error"},{status:500})}}async function E(){return i.NextResponse.json({endpoint:"/api/generate",method:"POST",description:"Generate platform-native hooks and CTAs from a brief",requiredFields:["brief","platforms"],supportedPlatforms:["youtube","tiktok","x","linkedin"],example:{brief:"How to build a content flywheel with zero budget",platforms:["youtube","tiktok","x","linkedin"]}})}async function f(){return new i.NextResponse("Method Not Allowed",{status:405,headers:{Allow:"GET, POST"}})}async function m(){return new i.NextResponse("Method Not Allowed",{status:405,headers:{Allow:"GET, POST"}})}async function S(){return new i.NextResponse("Method Not Allowed",{status:405,headers:{Allow:"GET, POST"}})}let h=new o.AppRouteRouteModule({definition:{kind:s.RouteKind.APP_ROUTE,page:"/api/generate/route",pathname:"/api/generate",filename:"route",bundlePath:"app/api/generate/route"},resolvedPagePath:"C:\\Projects\\Synqra\\apps\\synqra-mvp\\app\\api\\generate\\route.ts",nextConfigOutput:"standalone",userland:n}),{workAsyncStorage:g,workUnitAsyncStorage:b,serverHooks:w}=h;function A(){return(0,a.patchFetch)({workAsyncStorage:g,workUnitAsyncStorage:b})}},7032:()=>{},408:()=>{},7164:(e,t,r)=>{"use strict";r.d(t,{U:()=>i});var n=r(1525),o=r(4291);let s=null,a=null;try{let e=(0,o.getSupabaseUrl)(),t=(0,o.getSupabaseAnonKey)();s=(0,n.createClient)(e,t)}catch(e){a=e instanceof Error?e:Error("Unknown Supabase init error"),s=null}function i(){if(!s)throw Error("âŒ Supabase client not available. Ensure SUPABASE_URL and SUPABASE_ANON_KEY are set in Railway Variables and restart."+(a?` Details: ${a.message}`:""));return s}},4291:(e,t,r)=>{"use strict";r.d(t,{F:()=>i,getSupabaseAnonKey:()=>a,getSupabaseUrl:()=>s});let n=["SUPABASE_SERVICE_KEY","SUPABASE_SERVICE_ROLE"];function o(e,t){if(!e||""===e.trim())throw Error(`[Supabase Env] ${t} is missing or empty`);return e}function s(){let e=o(process.env.SUPABASE_URL,"SUPABASE_URL");return function(e,t){try{let r=new URL(e);if("http:"!==r.protocol&&"https:"!==r.protocol)throw Error(`[Supabase Env] ${t} must start with http:// or https://`)}catch(e){throw Error(`[Supabase Env] ${t} is invalid: ${e instanceof Error?e.message:"Unknown URL error"}`)}}(e,"SUPABASE_URL"),e}function a(){return o(process.env.SUPABASE_ANON_KEY,"SUPABASE_ANON_KEY")}function i(){let e=process.env.SUPABASE_SERVICE_ROLE_KEY;if(e&&""!==e.trim())return e;for(let e of n){let t=process.env[e];if(t&&""!==t.trim())return console.warn(`[Supabase Env] Falling back to ${e}. Set SUPABASE_SERVICE_ROLE_KEY and restart.`),t}throw Error("[Supabase Env] SUPABASE_SERVICE_ROLE_KEY is missing or empty")}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[6207,8048,1525],()=>r(6069));module.exports=n})();