(()=>{var e={};e.id=3326,e.ids=[3326,4291],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},4691:(e,t,a)=>{"use strict";a.r(t),a.d(t,{patchFetch:()=>v,routeModule:()=>w,serverHooks:()=>f,workAsyncStorage:()=>g,workUnitAsyncStorage:()=>A});var r={};a.r(r),a.d(r,{GET:()=>d,dynamic:()=>c,maxDuration:()=>l,runtime:()=>m});var n=a(1271),s=a(1232),o=a(8079),i=a(1238),u=a(1525),p=a(4291);let m="nodejs",c="force-dynamic",l=60;async function d(e){let t=Date.now(),a=[];try{a.push(await E()),a.push(await S()),a.push(await h());let e=a.filter(e=>"pass"===e.status).length,t=a.filter(e=>"fail"===e.status).length,r=a.filter(e=>"warn"===e.status).length,n="healthy";t>0?n=t>=3?"critical":"degraded":r>2&&(n="degraded");let s={overall:n,timestamp:new Date,checks:a,summary:{total:a.length,passed:e,failed:t,warnings:r},environment:process.env.RAILWAY_ENVIRONMENT||"development",autoRepairAttempted:!1},o="healthy"===n?200:"degraded"===n?500:503;return i.NextResponse.json(s,{status:o})}catch(a){console.error("[ENTERPRISE HEALTH] Unexpected error:",a);let e={overall:"critical",timestamp:new Date,checks:[{name:"health_check_execution",status:"fail",message:a instanceof Error?a.message:"Unknown error",duration:Date.now()-t,timestamp:new Date}],summary:{total:1,passed:0,failed:1,warnings:0},environment:process.env.RAILWAY_ENVIRONMENT||"development",autoRepairAttempted:!1};return i.NextResponse.json(e,{status:503})}}async function E(){let e=Date.now(),t=["SUPABASE_SERVICE_KEY","SUPABASE_SERVICE_ROLE"].filter(e=>!!process.env[e]);try{let a=(0,p.getSupabaseUrl)(),r=(0,p.getSupabaseAnonKey)(),n=(0,p.F)(),s=t.length>0||!process.env.SUPABASE_SERVICE_ROLE_KEY?"warn":"pass",o="warn"===s?`Canonical Supabase vars resolved with legacy aliases present: ${t.join(", ")||"none"}`:"Canonical Supabase env vars present";return{name:"environment_variables",status:s,message:o,duration:Date.now()-e,timestamp:new Date,metadata:{supabaseUrl:!!a,supabaseAnonKey:!!r,supabaseServiceRoleKey:!!n,legacyAliases:t}}}catch(t){return{name:"environment_variables",status:"fail",message:t instanceof Error?t.message:"Check failed",duration:Date.now()-e,timestamp:new Date}}}async function S(){let e=Date.now();try{let t=(0,u.createClient)((0,p.getSupabaseUrl)(),(0,p.getSupabaseAnonKey)()),{error:a}=await t.from("profiles").select("count").limit(1).maybeSingle();if(a&&"PGRST116"!==a.code)return{name:"database_connection",status:"warn",message:`Database warning: ${a.message}`,duration:Date.now()-e,timestamp:new Date};return{name:"database_connection",status:"pass",message:"Database connected",duration:Date.now()-e,timestamp:new Date}}catch(t){return{name:"database_connection",status:"fail",message:t instanceof Error?t.message:"Connection failed",duration:Date.now()-e,timestamp:new Date}}}async function h(){let e=Date.now();try{let t=process.memoryUsage(),a=Math.round(t.heapUsed/1024/1024),r=Math.round(t.heapTotal/1024/1024),n=Math.round(t.rss/1024/1024),s=a/r*100;if(s>90)return{name:"memory_usage",status:"fail",message:`High memory usage: ${a}MB / ${r}MB (${s.toFixed(1)}%)`,duration:Date.now()-e,timestamp:new Date,metadata:{heapUsedMB:a,heapTotalMB:r,rssMB:n,heapUsagePercent:s}};if(s>80)return{name:"memory_usage",status:"warn",message:`Memory usage: ${a}MB / ${r}MB (${s.toFixed(1)}%)`,duration:Date.now()-e,timestamp:new Date,metadata:{heapUsedMB:a,heapTotalMB:r,rssMB:n,heapUsagePercent:s}};return{name:"memory_usage",status:"pass",message:`Memory usage: ${a}MB / ${r}MB (${s.toFixed(1)}%)`,duration:Date.now()-e,timestamp:new Date,metadata:{heapUsedMB:a,heapTotalMB:r,rssMB:n,heapUsagePercent:s}}}catch(t){return{name:"memory_usage",status:"warn",message:"Could not check memory",duration:Date.now()-e,timestamp:new Date}}}let w=new n.AppRouteRouteModule({definition:{kind:s.RouteKind.APP_ROUTE,page:"/api/health/enterprise/route",pathname:"/api/health/enterprise",filename:"route",bundlePath:"app/api/health/enterprise/route"},resolvedPagePath:"C:\\Projects\\Synqra\\apps\\synqra-mvp\\app\\api\\health\\enterprise\\route.ts",nextConfigOutput:"standalone",userland:r}),{workAsyncStorage:g,workUnitAsyncStorage:A,serverHooks:f}=w;function v(){return(0,o.patchFetch)({workAsyncStorage:g,workUnitAsyncStorage:A})}},7032:()=>{},408:()=>{},4291:(e,t,a)=>{"use strict";a.d(t,{F:()=>i,getSupabaseAnonKey:()=>o,getSupabaseUrl:()=>s});let r=["SUPABASE_SERVICE_KEY","SUPABASE_SERVICE_ROLE"];function n(e,t){if(!e||""===e.trim())throw Error(`[Supabase Env] ${t} is missing or empty`);return e}function s(){let e=n(process.env.SUPABASE_URL,"SUPABASE_URL");return function(e,t){try{let a=new URL(e);if("http:"!==a.protocol&&"https:"!==a.protocol)throw Error(`[Supabase Env] ${t} must start with http:// or https://`)}catch(e){throw Error(`[Supabase Env] ${t} is invalid: ${e instanceof Error?e.message:"Unknown URL error"}`)}}(e,"SUPABASE_URL"),e}function o(){return n(process.env.SUPABASE_ANON_KEY,"SUPABASE_ANON_KEY")}function i(){let e=process.env.SUPABASE_SERVICE_ROLE_KEY;if(e&&""!==e.trim())return e;for(let e of r){let t=process.env[e];if(t&&""!==t.trim())return console.warn(`[Supabase Env] Falling back to ${e}. Set SUPABASE_SERVICE_ROLE_KEY and restart.`),t}throw Error("[Supabase Env] SUPABASE_SERVICE_ROLE_KEY is missing or empty")}}};var t=require("../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[6207,8048,1525],()=>a(4691));module.exports=r})();